{"ast":null,"code":"import * as React from 'react';\nimport { createContext } from 'react';\nimport { useClientContext } from '../hooks/useClientContext';\nimport { StorageService } from '../service/Storage';\nexport const AuthContext = createContext({});\nexport const AuthProvider = props => {\n  const client = useClientContext();\n  const [authProviders, setAuthProviders] = React.useState();\n  const actions = {\n    registerWithEmail: async (email, password) => {\n      await (client == null ? void 0 : client.collection('users').create({\n        email: email,\n        password: password,\n        passwordConfirm: password\n      }));\n    },\n    signInWithEmail: async (email, password) => {\n      await (client == null ? void 0 : client.collection('users').authWithPassword(email, password));\n    },\n    signInWithProvider: async provider => {\n      const authProvider = authProviders == null ? void 0 : authProviders.find(p => p.name === provider);\n      const redirectURL = typeof document !== 'undefined' ? props.webRedirectUrl : props.mobileRedirectUrl;\n      const url = (authProvider == null ? void 0 : authProvider.authUrl) + redirectURL;\n      await StorageService.set('provider', JSON.stringify(authProviders));\n      await props.openURL(url);\n    },\n    submitProviderResult: async url => {\n      const params = new URLSearchParams(url.split('?')[1]);\n      const code = params.get('code');\n      const state = params.get('state');\n      const providersString = await StorageService.get('provider');\n      if (providersString) {\n        const providers = JSON.parse(providersString);\n        const authProvider = providers == null ? void 0 : providers.find(p => p.state === state);\n        if (authProvider && code) {\n          await (client == null ? void 0 : client.collection('users').authWithOAuth2(authProvider.name, code, authProvider.codeVerifier, typeof document !== 'undefined' ? props.webRedirectUrl : props.mobileRedirectUrl));\n        }\n      }\n    },\n    signOut: () => {\n      client == null ? void 0 : client.authStore.clear();\n    },\n    sendPasswordResetEmail: async email => {\n      await (client == null ? void 0 : client.collection('users').requestPasswordReset(email));\n    },\n    sendEmailVerification: async email => {\n      await (client == null ? void 0 : client.collection('users').requestVerification(email));\n    },\n    updateProfile: async (id, record) => {\n      await (client == null ? void 0 : client.collection('profiles').update(id, record));\n    },\n    updateEmail: async email => {\n      await (client == null ? void 0 : client.collection('users').requestEmailChange(email));\n    },\n    deleteUser: async id => {\n      await (client == null ? void 0 : client.collection('users').delete(id));\n    }\n  };\n  React.useEffect(() => {\n    (async () => {\n      const methods = await (client == null ? void 0 : client.collection('users').listAuthMethods());\n      setAuthProviders(methods == null ? void 0 : methods.authProviders);\n    })();\n  }, [props.webRedirectUrl, props.mobileRedirectUrl]);\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: actions\n  }, props.children);\n};","map":{"version":3,"names":["React","createContext","useClientContext","StorageService","AuthContext","AuthProvider","props","client","authProviders","setAuthProviders","useState","actions","registerWithEmail","email","password","collection","create","passwordConfirm","signInWithEmail","authWithPassword","signInWithProvider","provider","authProvider","find","p","name","redirectURL","document","webRedirectUrl","mobileRedirectUrl","url","authUrl","set","JSON","stringify","openURL","submitProviderResult","params","URLSearchParams","split","code","get","state","providersString","providers","parse","authWithOAuth2","codeVerifier","signOut","authStore","clear","sendPasswordResetEmail","requestPasswordReset","sendEmailVerification","requestVerification","updateProfile","id","record","update","updateEmail","requestEmailChange","deleteUser","delete","useEffect","methods","listAuthMethods","createElement","Provider","value","children"],"sources":["/Users/robinrattasep/Downloads/pb_react/node_modules/pocketbase-react/es/context/auth.js"],"sourcesContent":["import * as React from 'react';\nimport { createContext } from 'react';\nimport { useClientContext } from '../hooks/useClientContext';\nimport { StorageService } from '../service/Storage';\nexport const AuthContext = createContext({});\nexport const AuthProvider = props => {\n  const client = useClientContext();\n  const [authProviders, setAuthProviders] = React.useState();\n  const actions = {\n    registerWithEmail: async (email, password) => {\n      await (client == null ? void 0 : client.collection('users').create({\n        email: email,\n        password: password,\n        passwordConfirm: password\n      }));\n    },\n    signInWithEmail: async (email, password) => {\n      await (client == null ? void 0 : client.collection('users').authWithPassword(email, password));\n    },\n    signInWithProvider: async provider => {\n      const authProvider = authProviders == null ? void 0 : authProviders.find(p => p.name === provider);\n      const redirectURL = typeof document !== 'undefined' ? props.webRedirectUrl : props.mobileRedirectUrl;\n      const url = (authProvider == null ? void 0 : authProvider.authUrl) + redirectURL;\n      await StorageService.set('provider', JSON.stringify(authProviders));\n      await props.openURL(url);\n    },\n    submitProviderResult: async url => {\n      const params = new URLSearchParams(url.split('?')[1]);\n      const code = params.get('code');\n      const state = params.get('state');\n      const providersString = await StorageService.get('provider');\n      if (providersString) {\n        const providers = JSON.parse(providersString);\n        const authProvider = providers == null ? void 0 : providers.find(p => p.state === state);\n        if (authProvider && code) {\n          await (client == null ? void 0 : client.collection('users').authWithOAuth2(authProvider.name, code, authProvider.codeVerifier, typeof document !== 'undefined' ? props.webRedirectUrl : props.mobileRedirectUrl));\n        }\n      }\n    },\n    signOut: () => {\n      client == null ? void 0 : client.authStore.clear();\n    },\n    sendPasswordResetEmail: async email => {\n      await (client == null ? void 0 : client.collection('users').requestPasswordReset(email));\n    },\n    sendEmailVerification: async email => {\n      await (client == null ? void 0 : client.collection('users').requestVerification(email));\n    },\n    updateProfile: async (id, record) => {\n      await (client == null ? void 0 : client.collection('profiles').update(id, record));\n    },\n    updateEmail: async email => {\n      await (client == null ? void 0 : client.collection('users').requestEmailChange(email));\n    },\n    deleteUser: async id => {\n      await (client == null ? void 0 : client.collection('users').delete(id));\n    }\n  };\n  React.useEffect(() => {\n    (async () => {\n      const methods = await (client == null ? void 0 : client.collection('users').listAuthMethods());\n      setAuthProviders(methods == null ? void 0 : methods.authProviders);\n    })();\n  }, [props.webRedirectUrl, props.mobileRedirectUrl]);\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: actions\n  }, props.children);\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}